jQuery(document).ready(function(t){"use strict";var e=t("#add-new"),a=t("#add-new-name"),i=t("#ywccp_field_add_edit_form"),d=t("#ywccp_checkout_fields"),n=function(e,a,i,d,n){if(e.attr("data-row",d),e.attr("data-action",i),!n){var c=e.find("tr.remove_default");c.length&&c.remove()}e.find('select[name="field_type"]').on("change",function(){var a=e.find("tr[data-hide]"),i=t(this).val();a.length&&t.each(a,function(){var e=t(this).data("hide").split(",");t.inArray(i,e)>-1?t(this).hide():t(this).show()})}).trigger("change"),e.dialog({title:a,modal:!0,width:500,resizable:!1,autoOpen:!1,buttons:[{text:"Save",click:function(){t.edit_add_field(this)&&t(this).dialog("close")}}],close:function(t,a){e.dialog("destroy"),e.remove()}})},c=function(t){var e=d.data("prepend");return t=(t=t.trim()).replace(/\s/g,"_"),""!=e&&-1===t.indexOf(e)&&(t=e+t),t};a.on("focus",function(){t(this).removeClass("required field-exists")}),e.on("click",function(){var t=a.val();if(""==t)return a.addClass("required"),!1;if(t=c(t),d.find('input.field_name[value="'+t+'"]').length)return a.addClass("field-exists"),!1;var e=i.clone();n(e,ywccp_admin.popup_add_title,"add","",!0),e.find('input[name="field_name"]').val(t),e.dialog("open")}),t(document).on("click","button.edit_field",function(){var e=t(this).closest("tr"),a=e.data("row"),d=e.find('input[type="hidden"]'),c=i.clone();t.each(d,function(e,a){var i=t(a).data("name"),d=c.find('td *[name="'+i+'"]');"checkbox"==d.attr("type")?0==t(a).val()?d.removeAttr("checked"):d.attr("checked","checked"):d.val(t(a).val())}),n(c,ywccp_admin.popup_edit_title,"edit",a,e.hasClass("is_custom")),c.dialog("open")}),t.edit_add_field=function(e){var a,i,n=d.find("tbody tr"),l=t(e).data("action");if("edit"==l?(i=t(e).data("row"),a=n.filter('[data-row="'+i+'"]')):(a=n.filter(":not(.disabled-row)").last().clone(),i=n.size(),a.attr("data-row",i),a.addClass("is_custom")),t.each(a.find('input[type="hidden"]'),function(i,d){var n=t(d).data("name"),l=t(e).find('td *[name="'+n+'"]'),o="",r="";l.length&&("checkbox"==l.attr("type")?r=1==(o=l.is(":checked")?1:0)?ywccp_admin.enabled:"-":(o=l.val(),"field_name"==n&&(o=c(o)),r=o),t(d).val(o),a.find(".td_"+n).html(r))}),"add"==l&&(n.last().after(a),void 0!==t.fn.tipTip)){a.find(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})}return!0},t(".check-column input").on("change",function(){t(this);var e=t("td.td_select input");t(this).is(":checked")?e.attr("checked","checked"):e.removeAttr("checked")}),t(document).on("click","button.enable_field",function(){var e,a=t(this),i=a.closest("tr"),d=i.find('input[data-name="field_enabled"]');i.toggleClass("disabled-row"),d.length&&d.val(i.hasClass("disabled-row")?"0":"1"),e=a.html(),a.html(a.data("label")),a.data("label",e)});t(document).on("click","button.remove_field",function(){var e=t(this).closest("tr");e.hasClass("is_custom")&&e.fadeOut(400,function(){e.addClass("disabled-row").hide(),e.find('input[data-name="field_deleted"]').val("yes")})});var l=t(".ywccp_multiselect_admin"),o=t(".ywccp_datepicker_admin");l&&t.each(l,function(){var e=t(this),a=e.data("value").split(", ");e.after('<input type="hidden" name="'+e.attr("name")+'" value>'),e.on("change",function(){var e=t(this).val();e=e?e.join(", "):"",t(this).next().val(e)}),e.val(a).trigger("change"),void 0!==t.fn.select2&&e.select2()}),void 0!==t.fn.datepicker&&o&&t.each(o,function(){t(this).datepicker({dateFormat:t(this).data("format")||"dd-mm-yy"})})});